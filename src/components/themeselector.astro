---
import { Icon } from "astro-icon/components";
---

<div
	class="flex items-center pl-2 rounded-md text-sm font-semibold text-center transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 border outline-2 outline-offset-2 border-gray-300 text-gray-700 hover:border-gray-400 active:bg-gray-100 dark:active:bg-stone-950"
	aria-label="Theme selection">
	<Icon name="fluent:dark-theme-20-filled" class="w-5 dark:text-white" />
	<label for="theme-selector" class="sr-only">Choose a theme</label>
	<select
		x-data="{
				theme: localStorage.theme || 'light',
				applyTheme: function() {
					var theme = localStorage.theme || 'light';
					var dark = false;
					if (theme === 'dark') dark = true;
					else if (theme === 'light') dark = false;
					else if (theme === 'system') dark = window.matchMedia('(prefers-color-scheme: dark)').matches;
					else {
						var h = new Date().getHours();
						dark = h < 6 || h >= 19;
					}
					document.documentElement.classList.toggle('dark', dark);
				},
				switchTheme: function (newValue) {
					localStorage.theme = newValue;
					this.applyTheme();
				},
			}"
		name="theme-selector"
		id="theme-selector"
		class="appearance-none cursor-pointer rounded-md pl-3 pr-2 py-1.5 dark:bg-stone-950 dark:text-white focus-visible:outline-none"
		x-model="theme"
		aria-label="Choose a theme"
		@change="switchTheme($event.target.value)">
		<option value="light">Día (claro)</option>
		<option value="dark">Noche (oscuro)</option>
		<option value="auto">Automático (según hora)</option>
		<option value="system">Según sistema</option>
	</select>
</div>
